<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Shopping</title>
    <!-- <meta name="description" content="Shopping - A-Frame"> -->
    <!-- <link rel="stylesheet" href="vendor/demo.css"> -->

    <!-- Tracking & Tools -->
    <script src="vendor/tracking-min.js"></script>
    <script src="vendor/dat.gui.min.js"></script>
    <script src="vendor/stats.min.js"></script>
    <script src="vendor/color_camera_gui.js"></script>
    <!-- A-Frame Materials -->
    <script src="vendor/aframe.js"></script>
    <script src="https://rawgit.com/ngokevin/aframe-layout-component/master/dist/aframe-layout-component.min.js"></script>
    <script src="https://rawgit.com/ngokevin/aframe-template-component/master/dist/aframe-template-component.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/nunjucks/2.3.0/nunjucks.min.js"></script>
    <!-- Other -->
    <script src="js/main.js"></script>
    <script src="js/main-aframe.js"></script>
    <link rel="stylesheet" href="css/styles.css">
  </head>

  <body>
    
    <!-- ================= Video container ====================== -->
    <div class="demo-container">
      <!-- Horizontal - for testing on computer -->
      <!-- <video id="video" width="160" height="120" preload autoplay loop muted></video>
      <canvas id="canvas" width="160" height="120"></canvas> -->
      <!-- <video id="video" width="320" height="240" preload autoplay loop muted></video> -->
      <!-- <canvas id="canvas" width="320" height="240"></canvas> -->
      
      <!-- Vertical - for viewing on phone -->
      <video id="video" width="100" height="100" preload autoplay loop muted></video>
      <canvas id="canvas" width="100" height="100"></canvas>
      <!-- <video id="video" width="240" height="320" preload autoplay loop muted></video> -->
      <!-- <canvas id="canvas" width="240" height="320"></canvas> -->
    </div>

    <!-- ======================= A-Frame ========================= -->

    <a-scene>
      <!-- Assets -->
      <a-assets>
        <a-asset-item id="test-obj" src="assets/test-tex.obj"></a-asset-item>
        <a-asset-item id="test-mtl" src="assets/test-tex.mtl"></a-asset-item>

        <img id="enemy-sprite" crossorigin="" src="https://ucarecdn.com/f11bb3e6-ceb4-427c-bcaa-351cabac37d5/">

        <script id="enemies" type="text/x-nunjucks-template">
          <a-entity layout="type: circle; radius: 5" position="0 0.5 0">
            <a-animation attribute="rotation" dur="30000" easing="linear" repeat="indefinite" to="0 360 0"></a-animation>

            {% for x in range(num) %}
            <a-image class="enemy" look-at="#player" src="#enemy-sprite" transparent="true">
              <!-- Attach collision handler animations. -->
              <a-animation attribute="opacity" begin="collider-hit" dur="400" ease="linear"
                           from="1" to="0"></a-animation>
              <a-animation attribute="scale" begin="collider-hit" dur="400" ease="linear"
                           to="0 0 0"></a-animation>
            </a-image>
            {% endfor %}
          </a-entity>
        </script>
        
        <!-- Laser. -->
        <a-mixin id="laser"
                 geometry="primitive: cylinder; radius: 0.05; translate: 0 -2 0"
                 material="color: green; metalness: 0.2; opacity: 0.4; roughness: 0.3"
                 rotation="90 0 0"
                 projectile="speed: -0.5"
                 collider="target: .enemy"></a-mixin>
      </a-assets>
      <!-- End Assets -->


      <a-entity obj-model="obj: #test-obj; mtl: #test-mtl"></a-entity>
      <a-entity template="src: #enemies" data-num="10"></a-entity>

      <!-- Add spawner and click-listener to player. -->
      <a-camera id="player" position="0 1.8 0" spawner="mixin: laser; on: click" click-listener></a-camera>
      <a-box id="gun" color="tomato" depth="0.5" height="0.5" width="0.5" position="0 1 -1"></a-box>
      <a-sky color="#252243"></a-sky>
    </a-scene>

  </body>
</html>
